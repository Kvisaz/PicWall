# PicWall
Приложение для просмотра картинок из интернета (тестовое задание)

## Что пока не готово
- дизайн под разные разрешения и повороты экрана (пока только на landscape tablet)
- нужно исправить баги скроллинга большой картинки при переходе между страницами

## Что готово
- картинки берутся из  https://api.desktoppr.co/1/wallpapers
- картинки выводятся сеткой
- пагинация картинок в сетке
- при клике на элементе сетки открывается большое превью
- загрузка картинок в других потоках (используется пул ExecutorService)
- кэширование в файловой системе
- кэширование загрузки картинок в памяти
- отображение индикатора загрузки для больших картинок (используется обратная связь с UI через handler)

## Ограничения
- Android 4.0+ - выполнено (тестирую на планшете Nook HD+, 4.0.4, API 15)  
- Не использовать сторонние библиотеки загрузки картинок - выполнено. 

## Использованные библиотеки
- Retrofit 2
- Eventbus 3
- Dagger 2
- [sectioned-recyclerview](https://github.com/afollestad/sectioned-recyclerview) - для вывода информации о страницах галереи. Выглядит наглядно, но усложняет расчёты. Не включал в gradle, просто скопировал файл (он там один)

## Таймлог - 45 часа на данный момент
Учитываются чистые, "концентированные" часы, в которых шло собственно программирование.  

### среда 6 апреля - 4 часа
- Каркас-архитектура  -  2
- Иконка приложения - 0.5
- Сервер, модели данных, получение списка картинок - 1.5

### четверг 7 апреля - 6 часов
- Макет (сетка) - 1 + 0.5 + 1
- Рефакторинг под более абстрактные модели Picture, Page, чтобы было проще адаптировать к другим серверам и источникам картинок. - 0.5 
- Загрузчик картинок (загрузчик превью) - 3
  
### суббота 9 апреля - 3 часа
- загрузчик превью	-  3 часа.  Заработал. Разобрался с Looper и Handler, спасибо.

### воскресенье 10 апреля - 3 часа
- тестирование загрузчика на других телефонах (SDK23) - 1
- правка файлового кэша  - 2
> Отказ от внешнего хранилища. Поставил ограничение на макс число файлов и автоматическое удаление самых старых

### понедельник 11 апреля - 6 часов
1. Переписал загрузчик на Dagger  - 3 часа
> Обоснование: загрузчику нужен контекст, а он используется только в файловом кэше. Далее, я хочу использовать этот же загрузчик и в компоненте просмотра большой картинки - но исходная архитектура туториала предполагает создание экземпляра ImageLoader в компоненте. Dependency Injection позволит решить обе эти проблемы.

Итоги: 
Презентер больше не создаётся внутри Activity (недочёт моего предыдущего подхода к архитектуре).
ImageLoader теперь независимый синглтон, можно использовать в разных компонентах

2. Загрузка большой картинки - 3 часа

### вторник 12 апреля - 3 часа
- Дизайн индикатора + общий дизайн немного - 1 час
- Рефакторинг ImageLoader  - 2 часа

### среда 13 апреля - 5 часов
1. индикатор загрузки - 2 часа
> Вывод надписи над индикатором (универсальный класс ProgressIndicator). 
> Баг индикатора (выводился не полностью, причина - типичный int division)
2. пагинация Desktoprr - 3 часа

### четверг 14 апреля - 2 часа
- пагинация Desktoprr - 1.5
- окраска фона - 1  (пытался подобрать идеальную функцию для цвета текста, оставил простой выбор между черным и белым, см. ColorUtils.java)
- вывод страницы текущей  (заголовок разделителя?) - 0.5

### пятница 15 апреля - 2.5 часа
- пагинация Desktoprr - 2 часа

### суббота 16 апреля - 2.5  часа
- пагинация Desktoprr - 2.5 часа
- переход на секционированный RecycleView (инфо о страницах выводятся в сетке)
- шлифовка поведения при дозагрузке и удалении страниц для бесконечного скролла
- оптимизация памяти (удаление "хвостов" при прокрутке, чтобы не загружать в память все 4000 страниц)

### воскресенье 17 апреля - 6 часов
- свайп большой картинки - 6 часов
- решение на базе RecycledView (обычный, без секций)
- префетчинг соседей после загрузки картинки

### понедельник 17 апреля - 2 часа
- свайп большой картинки - 2 с утра
- выделение картинки в сетке при переходе 
- переходы между страницами, запрос новой страницы с сервера 
- баги, отладка 






